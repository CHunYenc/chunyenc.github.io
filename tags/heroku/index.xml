<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Heroku on CY | 程式小角落</title><link>https://chunyenc.github.io/tags/heroku/</link><description>Recent content in Heroku on CY | 程式小角落</description><generator>Hugo -- gohugo.io</generator><language>zh-tw</language><managingEditor>admin@chunyen.xyz (陳雋諺, Chun-Yen Chen)</managingEditor><webMaster>admin@chunyen.xyz (陳雋諺, Chun-Yen Chen)</webMaster><lastBuildDate>Thu, 13 Apr 2023 02:46:15 +0000</lastBuildDate><atom:link href="https://chunyenc.github.io/tags/heroku/index.xml" rel="self" type="application/rss+xml"/><item><title>Logtail - 一個彙整免費 Paas 平台的日誌平台</title><link>https://chunyenc.github.io/p/logtail-log-management/</link><pubDate>Thu, 13 Apr 2023 02:46:15 +0000</pubDate><author>admin@chunyen.xyz (陳雋諺, Chun-Yen Chen)</author><guid>https://chunyenc.github.io/p/logtail-log-management/</guid><description>筆者從 papertrailapp 毫不猶豫直接跳到 logtail.</description><tags><tag>Logtail</tag><tag>Render.com</tag><tag>Heroku</tag></tags><categories><category>Experience</category></categories><image/><content>&lt;h1 id="前言">前言&lt;/h1>
&lt;p>因筆者有使用 Heroku、Render.com、Railway 的經驗，那他們都是 PaaS (Platform as a Service，平台及服務) 的服務平台。&lt;/p>
&lt;blockquote>
&lt;p>這些 PaaS 平台通常提供了開發工具、執行環境、資料庫、身份驗證、監控等服務，讓開發人員可以專注於應用程式的開發，而不必擔心基礎架構的建設。&lt;/p>
&lt;/blockquote>
&lt;p>筆者在這邊有分配不同平台的使用情境：(沒列就是我沒使用 ..)&lt;/p>
&lt;ul>
&lt;li>&lt;code>Heroku&lt;/code>：主要負責應用上線 &lt;code>學生身分免費&lt;/code>&lt;/li>
&lt;li>&lt;code>Render.com&lt;/code>：主要負責應用上線、靜態網站 &lt;code>免費&lt;/code>&lt;/li>
&lt;li>&lt;code>Railway.app&lt;/code>：主要負責 RDBMS 資料庫 (PostgreSQL)、快取資料庫 (Redis) &lt;code>免費&lt;/code>
&lt;ul>
&lt;li>&lt;strong>Railway.app&lt;/strong> 目前有推薦機制，筆者的推薦連結 &amp;ndash;&amp;gt; &lt;a class="link" href="https://railway.app?referralCode=37Lpxy" target="_blank" rel="noopener"
>https://railway.app?referralCode=37Lpxy&lt;/a>&lt;/li>
&lt;li>&lt;strong>Railway.app 目前還沒有支援 log stream&lt;/strong>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>那可以知道我在 PaaS 的部份用的非常兇猛，甚至 logging 非常分散，但是 &lt;code>機器不同源，日誌是類似&lt;/code>。所以我需要一個有效的方式來&lt;code>收集&lt;/code>、&lt;code>管理&lt;/code>和&lt;code>分析&lt;/code>這些日誌，以便進行&lt;code>錯誤排查&lt;/code>、&lt;code>性能優化&lt;/code>和&lt;code>安全監控&lt;/code>等。&lt;/p>
&lt;p>接下來就是要來講比較實際的 Logtail 的 &lt;code>使用過程(串接)&lt;/code> 到 &lt;code>好處(優點)&lt;/code>。&lt;/p>
&lt;h1 id="好處一無痛串接-paas-平台">好處一：無痛串接 Paas 平台&lt;/h1>
&lt;h2 id="heroku">Heroku&lt;/h2>
&lt;p>綁定 &lt;code>Heroku&lt;/code> 前，先到 &lt;code>Logtail&lt;/code> 申請後就可以直接來用了 .. (如下圖)&lt;/p>
&lt;p>&lt;img src="https://chunyenc.github.io/images/20230413_logtail/01.png"
loading="lazy"
alt="綁定的過程"
>&lt;/p>
&lt;p>所以你只要做四件事：&lt;/p>
&lt;ol>
&lt;li>把你的應用程式部屬到 &lt;code>Heroku&lt;/code>，確定可以使用 !&lt;/li>
&lt;li>到 &lt;code>Logtail&lt;/code> 申請一個 &lt;code>來源(Sources)&lt;/code>，依照上圖的步驟操作一次。&lt;/li>
&lt;li>然後你就不斷地在 &lt;code>1 步驟&lt;/code> 的應用程式不斷刷新頁面.&lt;/li>
&lt;li>觀察 Logtail 有沒有新增加 logging.&lt;/li>
&lt;/ol>
&lt;h2 id="rendercom">Render.com&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">待補，但基本上跟上面一樣 ..
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="好處二內建-grafana-視覺化平台">好處二：內建 Grafana 視覺化平台&lt;/h1>
&lt;p>Grafana 是一個流行的開源數據視覺化和監控平台，它提供了&lt;code>強大的儀表板&lt;/code>和&lt;code>視覺化工具&lt;/code>。&lt;/p>
&lt;p>我今天也主要不是探討這個平台，自己用的也不是非常熟。&lt;/p>
&lt;blockquote>
&lt;p>筆者使用 papertrailapp 只能串接到自己的視覺化平台，超貴。&lt;/p>
&lt;/blockquote>
&lt;h1 id="好處三異常通知">好處三：異常通知&lt;/h1>
&lt;blockquote>
&lt;p>papertrailapp 一樣有。&lt;/p>
&lt;/blockquote>
&lt;h1 id="好處三其他平台有的基本上都有-">好處三：其他平台有的基本上都有 ..&lt;/h1>
&lt;h1 id="缺點錢">缺點：錢&lt;/h1>
&lt;h1 id="建議還是自架">建議：還是自架&lt;/h1>
&lt;p>主要還是回到錢的部分，一個月 24 USD 真的不便宜。&lt;/p>
&lt;p>目前是有朝向 Graylog(&lt;code>ElasticSearch&lt;/code> or &lt;code>OpenSearch&lt;/code>) + Grafana 來建。&lt;/p>
&lt;p>這邊之後再給大家講一下我的架構。&lt;/p></content></item><item><title>教學 01 - 如何讓 render.com 提供的機器不睡眠</title><link>https://chunyenc.github.io/p/wakup-machine/</link><pubDate>Fri, 27 Jan 2023 15:53:22 +0800</pubDate><author>admin@chunyen.xyz (陳雋諺, Chun-Yen Chen)</author><guid>https://chunyenc.github.io/p/wakup-machine/</guid><description>使用 heroku、render.com 等平台的免費機器，基本上都會自動睡眠.</description><tags><tag>GIT</tag><tag>Docker</tag><tag>Heroku</tag><tag>render</tag></tags><categories><category>Experience</category><category>Tutorial</category></categories><image/><content>&lt;h1 id="前言">前言&lt;/h1>
&lt;blockquote>
&lt;p>祝大家新年快樂 !!!&lt;/p>
&lt;/blockquote>
&lt;p>今天是初六，也休息一陣子了，覺得有點廢。&lt;/p>
&lt;p>主要是因為大四時擔任宿舍網路會長時製作的 LINE-BOT 上線在 &lt;code>heroku&lt;/code>，但是 &lt;code>2022/12&lt;/code> 已經公告說他們要開始收錢了。於是我就將 LINE-BOT 的伺服器轉移到 &lt;code>render.com&lt;/code> 平台。&lt;/p>
&lt;p>那在轉移時有製作一個工具。就是要不間斷的去呼叫免費平台(類似 heroku.com、render.com)。&lt;/p>
&lt;blockquote>
&lt;p>就是要讓機器永遠不睡眠 ! 操爆它 (X)&lt;/p>
&lt;/blockquote>
&lt;p>統整做了三件事：&lt;/p>
&lt;ol>
&lt;li>運用 Python 定時呼叫小應用的網址&lt;/li>
&lt;li>利用 Docker 彈性系統參數&lt;/li>
&lt;li>利用 Docker Compose 定時呼叫多個平台&lt;/li>
&lt;/ol>
&lt;p>本篇不是教你怎麼做這個工具，是教你如何用。&lt;/p>
&lt;p>所以會從 &lt;code>2.&lt;/code> 來教你怎麼做 !&lt;/p>
&lt;!-- raw HTML omitted -->
&lt;!-- raw HTML omitted -->
&lt;h1 id="利用-docker-來使用工具">利用 Docker 來使用工具&lt;/h1>
&lt;p>&lt;code>工具只需要透過 Docker 就可以執行囉 !&lt;/code>&lt;/p>
&lt;p>範例如下：&lt;code>範例下方還有部分說明唷 !&lt;/code>&lt;/p>
&lt;p>&lt;code>**** 記得要先建立一個 schedule.log 檔案。&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker run -d &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>--restart always &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>--name wakeup-render &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>-e &lt;span class="nv">URL&lt;/span>&lt;span class="o">=&lt;/span>https://yourwebsite.domain.com/ &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>-e &lt;span class="nv">APSCHEDULER_DAY_OF_WEEK&lt;/span>&lt;span class="o">=&lt;/span>mon-fri &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>-e &lt;span class="nv">APSCHEDULER_MINUTE&lt;/span>&lt;span class="o">=&lt;/span>*/10 &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>-v /Users/yen/Desktop/schedule.log:/app/scheduler.log &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>chunyenc/wakeup-machine
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;code>--restart&lt;/code> 若重開機將自動執行&lt;/li>
&lt;li>&lt;code>--name&lt;/code> container 的名稱&lt;/li>
&lt;li>&lt;code>-e&lt;/code> 環境變數
&lt;ul>
&lt;li>URL 是你要呼叫的網址&lt;/li>
&lt;li>APSCHEDULER_DAY_OF_WEEK 一週裡面哪幾天執行&lt;/li>
&lt;li>APSCHEDULER_MINUTE 是多少分鐘呼叫一次&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>-v&lt;/code> 映射檔案
&lt;ul>
&lt;li>linux 可以使用 &lt;code>pwd&lt;/code> 指令來查看目前的絕對路徑&lt;/li>
&lt;li>schedule.log 就是查看執行 log 的檔案&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="環境變數列表">環境變數列表&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>環境變數&lt;/th>
&lt;th>範例值&lt;/th>
&lt;th>備註&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>URL&lt;/td>
&lt;td>&lt;a class="link" href="https://chunyen.xyz" target="_blank" rel="noopener"
>https://chunyen.xyz&lt;/a>&lt;/td>
&lt;td>呼叫的網址&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>APSCHEDULER_YEAR&lt;/td>
&lt;td>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>APSCHEDULER_MONTH&lt;/td>
&lt;td>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>APSCHEDULER_DAY&lt;/td>
&lt;td>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>APSCHEDULER_WEEK&lt;/td>
&lt;td>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>APSCHEDULER_DAY_OF_WEEK&lt;/td>
&lt;td>mon-fri&lt;/td>
&lt;td>依照範例，設定週一到週五&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>APSCHEDULER_HOUR&lt;/td>
&lt;td>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>APSCHEDULER_MINUTE&lt;/td>
&lt;td>*/10&lt;/td>
&lt;td>依照範例，設定每十分鐘&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>APSCHEDULER_SECOND&lt;/td>
&lt;td>&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;blockquote>
&lt;p>APSCHEDULER 需要參考下面網址來設定
&lt;a class="link" href="https://apscheduler.readthedocs.io/en/3.x/modules/triggers/cron.html" target="_blank" rel="noopener"
>https://apscheduler.readthedocs.io/en/3.x/modules/triggers/cron.html&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;h1 id="如果是使用-docker-compose-">如果是使用 Docker Compose ..&lt;/h1>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;3.9&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">services&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">service-one&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">chunyenc/wakeup-machine&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">environment&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">URL=https://one.chunyen.xyz&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">APSCHEDULER_MINUTE=*/10&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">APSCHEDULER_HOUR=0-1,5-23&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">APSCHEDULER_DAY_OF_WEEK=mon-fri&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">./pricing.log:/app/scheduler.log&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">service-two&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">chunyenc/wakeup-machine&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">environment&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">URL=https://two.chunyen.xyz&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">APSCHEDULER_MINUTE=*/10&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">APSCHEDULER_HOUR=9-23&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">./linebot.log:/app/scheduler.log&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></content></item></channel></rss>